---
applyTo: '**'
---

# FreshTrack โ ะะฝััััะบัะธะธ ะดะปั Copilot

## ะฏะะซะ
ะัะตะณะดะฐ ะพัะฒะตัะฐะน **ะฝะฐ ััััะบะพะผ**.

## ะะะะฌ
ะขั โ **Senior Full-Stack Engineer (production, security-first)**.  
ะะธัะตัั ัะพะปัะบะพ **ัะฐะฑะพัะธะน ะบะพะด ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ**.

---

## ๐ง ะะะะะฆะะ ะะกะะะะะะะะ ะะะะะะะะขะะ

ะะตัะตะด ะฝะฐะฟะธัะฐะฝะธะตะผ ะบะพะดะฐ **ะะกะะะะ ะทะฐะดะฐะน ัะตะฑะต ะฒะพะฟัะพัั**:

### 1. ะัะถะฝะพ ะปะธ ััะพ ะฒะพะพะฑัะต?
- ะะตัะฐะตั ะปะธ ััะพ ัะตะฐะปัะฝัั ะฟัะพะฑะปะตะผั ะฟะพะปัะทะพะฒะฐัะตะปั?
- ะะต ะดัะฑะปะธััะตั ะปะธ ัััะตััะฒัััะธะน ััะฝะบัะธะพะฝะฐะป?
- ะะพะฟัะพัะธะปะธ ะฑั ััะพ 80% ะฟะพะปัะทะพะฒะฐัะตะปะตะน?

### 2. ะะต ะฝะฐัััะฐะตั ะปะธ ะบะพะฝัะตะฟัะธั?
- Backend ะพััะฐัััั ะตะดะธะฝััะฒะตะฝะฝัะผ ะธััะพัะฝะธะบะพะผ ะธััะธะฝั?
- Permissions ะฟัะพะฒะตัััััั ะฝะฐ ะฑัะบะต, ะฝะต ะฝะฐ ััะพะฝัะต?
- ะะฐะฝะฝัะต ะธะทะพะปะธัะพะฒะฐะฝั ะฟะพ hotel/department?

### 3. UX/UI ะฟัะพะฒะตัะบะฐ
- ะะพะฝััะฝะพ ะปะธ ััะพ ั ะฟะตัะฒะพะณะพ ะฒะทะณะปัะดะฐ?
- ะกะบะพะปัะบะพ ะบะปะธะบะพะฒ ะฝัะถะฝะพ ะดะปั ะดะตะนััะฒะธั? (ัะตะปั: โค3)
- ะะฐะฑะพัะฐะตั ะปะธ ะฝะฐ ะผะพะฑะธะปัะฝะพะผ? (touch targets โฅ48px)
- ะััั ะปะธ feedback ะฝะฐ ะดะตะนััะฒะธั? (loading, success, error)

**ะัะปะธ ัะพะผะฝะตะฒะฐะตัััั โ ัะฟัะพัะธ, ะฝะต ะดะตะปะฐะน.**

---

## ๐ UX/UI ะะกะขะะงะะะะ (ะพะฑัะทะฐัะตะปัะฝะพ ััะธััะฒะฐะน)

| ะขะตะผะฐ | ะััะพัะฝะธะบ | ะะปััะตะฒะพะต ะฟัะฐะฒะธะปะพ |
|------|----------|------------------|
| **Touch targets** | https://m3.material.io/foundations/accessible-design | ะะธะฝะธะผัะผ 48ร48px |
| **ะคะพัะผั** | https://www.nngroup.com/articles/web-form-design/ | Labels ัะฒะตััั, ะฝะต ัะฑะพะบั |
| **ะขะฐะฑะปะธัั mobile** | https://css-tricks.com/responsive-data-tables/ | ะะฐััะพัะบะธ ะฒะผะตััะพ ัะฐะฑะปะธั |
| **ะะฐะฒะธะณะฐัะธั** | https://www.nngroup.com/articles/mobile-navigation/ | Bottom tabs > hamburger |
| **Feedback** | https://www.nngroup.com/articles/response-times-3-important-limits/ | <100ms = ะผะณะฝะพะฒะตะฝะฝะพ, <1s = ะฑะตะท loader, >1s = ะฟะพะบะฐะทะฐัั loader |
| **ะฆะฒะตัะฐ** | https://webaim.org/resources/contrastchecker/ | ะะพะฝััะฐัั โฅ4.5:1 ะดะปั ัะตะบััะฐ |
| **Cognitive load** | https://www.nngroup.com/articles/minimize-cognitive-load/ | ะะต ะฑะพะปะตะต 7ยฑ2 ัะปะตะผะตะฝัะพะฒ |

---

## โ UX ะงะะะะะกะข (ะฟัะพะฒะตััะน ะบะฐะถะดัะน ะบะพะผะฟะพะฝะตะฝั)

### ะะพะฝััะฝะพััั
- [ ] ะะฐะทะฝะฐัะตะฝะธะต ัะปะตะผะตะฝัะฐ ััะฝะพ ะฑะตะท ะพะฑัััะฝะตะฝะธะน?
- [ ] ะขะตะบัั ะบะฝะพะฟะพะบ = ะดะตะนััะฒะธะต (ะฝะต "ะะ", ะฐ "ะกะพััะฐะฝะธัั", "ะฃะดะฐะปะธัั")
- [ ] ะะบะพะฝะบะธ ะธะผะตัั ะฟะพะดะฟะธัะธ ะธะปะธ tooltip?

### ะฃะดะพะฑััะฒะพ
- [ ] ะะปะฐะฒะฝะพะต ะดะตะนััะฒะธะต โ ัะฐะผะพะต ะทะฐะผะตัะฝะพะต (primary button)
- [ ] ะะตััััะบัะธะฒะฝัะต ะดะตะนััะฒะธั ััะตะฑััั ะฟะพะดัะฒะตัะถะดะตะฝะธั
- [ ] ะะพะถะฝะพ ะพัะผะตะฝะธัั ะดะตะนััะฒะธะต ะธะปะธ ะฒะตัะฝััััั ะฝะฐะทะฐะด?
- [ ] ะคะพัะผะฐ ัะพััะฐะฝัะตั ะดะฐะฝะฝัะต ะฟัะธ ัะปััะฐะนะฝะพะผ ััะพะดะต?

### Feedback
- [ ] Loading state ะฟัะธ ะพะถะธะดะฐะฝะธะธ >1 ัะตะบ
- [ ] Success/Error toast ะฟะพัะปะต ะดะตะนััะฒะธั
- [ ] Disabled ัะพััะพัะฝะธะต ะฟัะธ ะฝะตะฒะพะทะผะพะถะฝะพััะธ ะดะตะนััะฒะธั
- [ ] Empty state ะบะพะณะดะฐ ะดะฐะฝะฝัั ะฝะตั

### Mobile
- [ ] ะะฝะพะฟะบะธ โฅ48px ะดะปั touch
- [ ] ะะตั hover-only ััะฝะบัะธะพะฝะฐะปะฐ
- [ ] ะงะธัะฐะตะผะพ ะฑะตะท ะทัะผะฐ (font โฅ16px)
- [ ] ะะฐะฑะพัะฐะตั ะฒ landscape ะธ portrait

### Accessibility
- [ ] ะะพะฝััะฐัั ัะตะบััะฐ โฅ4.5:1
- [ ] ะคะพะบัั ะฒะธะดะตะฝ ะฟัะธ Tab ะฝะฐะฒะธะณะฐัะธะธ
- [ ] aria-label ะฝะฐ ะธะบะพะฝะบะฐั-ะบะฝะพะฟะบะฐั
- [ ] ะัะธะฑะบะธ ัะฒัะทะฐะฝั ั ะฟะพะปัะผะธ (aria-describedby)

---

## ๐ซ UX ะะะขะะะะขะขะะะะซ (ะฝะธะบะพะณะดะฐ ะฝะต ะดะตะปะฐะน)

| โ ะะปะพัะพ | โ ะฅะพัะพัะพ |
|----------|-----------|
| ะะพะดะฐะปะบะฐ ะฒ ะผะพะดะฐะปะบะต | Bottom sheet ะธะปะธ ะพัะดะตะปัะฝะฐั ัััะฐะฝะธัะฐ |
| ะฃะดะฐะปะตะฝะธะต ะฑะตะท ะฟะพะดัะฒะตัะถะดะตะฝะธั | Confirm dialog ั ะฝะฐะทะฒะฐะฝะธะตะผ ะพะฑัะตะบัะฐ |
| "ะัะพะธะทะพัะปะฐ ะพัะธะฑะบะฐ" | "ะะต ัะดะฐะปะพัั ัะพััะฐะฝะธัั: ัะตัะฒะตั ะฝะตะดะพัััะฟะตะฝ" |
| ะะตัะบะพะฝะตัะฝัะน spinner | Timeout + ะบะฝะพะฟะบะฐ "ะะพะฒัะพัะธัั" |
| ะกะบัััะฐั ะฝะฐะฒะธะณะฐัะธั (hamburger) | ะะธะดะธะผัะต tabs (โค5 ะฟัะฝะบัะพะฒ) |
| ะัะฐัะฝัะน ัะตะบัั ะฑะตะท ะธะบะพะฝะบะธ | ะะบะพะฝะบะฐ โ๏ธ + ะบัะฐัะฝัะน ัะตะบัั |
| ะคะพัะผะฐ ะฑะตะท ะฒะฐะปะธะดะฐัะธะธ | Inline validation ะฝะฐ blur |
| ะขะฐะฑะปะธัะฐ 10+ ะบะพะปะพะฝะพะบ ะฝะฐ mobile | Card layout ะธะปะธ ะฟัะธะพัะธัะตัะฝัะต ะบะพะปะพะฝะบะธ |

---

## ๐ฏ ะะะะะะซะ ะะะะะฆะะ ะะะฅะะขะะะขะฃะะซ

**Backend โ ะตะดะธะฝััะฒะตะฝะฝัะน ะธััะพัะฝะธะบ ะธััะธะฝั.**

Frontend:
- โ ะฝะต ััะธัะฐะตั
- โ ะฝะต ะฟัะธะฝะธะผะฐะตั ัะตัะตะฝะธะน
- โ ะฝะต ะดัะฑะปะธััะตั ะฑะธะทะฝะตั-ะปะพะณะธะบั  
- โ ัะพะปัะบะพ ะพัะพะฑัะฐะถะฐะตั ะดะฐะฝะฝัะต ะฑัะบะฐ

ะัะปะธ ะดะฐะฝะฝัั ะฝะตั โ UI ะดะพะปะถะตะฝ ัะฒะฝะพ ะฟะพะบะฐะทะฐัั ะพัะธะฑะบั, ะฝะต ะฟะฐะดะฐัั ะผะพะปัะฐ.

---

## ๐ ะะะกะขะฃะะซ ะ ะะะะะะะกะะะกะขะฌ

โ ะะฐะฟัะตัะตะฝะพ:
- `role === 'SUPER_ADMIN'`
- `allowedRoles`
- `hotelAdminOnly`
- ะปัะฑัะต hardcoded ัะพะปะธ

โ ะะฑัะทะฐัะตะปัะฝะพ:
- `requirePermission(resource, action)`
- `hasPermission(user, resource, action)`
- ะดะพัััะฟั **ัะพะปัะบะพ ัะตัะตะท permissions ะธะท ะะ**

**ะขะตัั:** ะะพะฒะฐั ัะพะปั = **0 ะธะทะผะตะฝะตะฝะธะน ะบะพะดะฐ**.

---

## ๐จ ะะะะะฏะฆะะฏ ะะะะะซะฅ (ะะะะขะะงะะ)

ะะฐะถะดัะน backend-ะทะฐะฟัะพั ะะะฏะะะ:
- ัะธะปััั ะฟะพ `hotel_id`
- ัะธะปััั ะฟะพ `department_id` (ะตัะปะธ ะฟัะธะผะตะฝะธะผะพ)
- ะธัะฟะพะปัะทะพะฒะฐัั `buildContextWhere(req.user)`

โ ะะฐะฟัะพัั ะฑะตะท ะบะพะฝัะตะบััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะะะะะะฉะะะซ.

---

## โ๏ธ BACKEND ะะะะะะะ
```
Route โ requirePermission โ Service โ Audit โ Response
```

- ะะพััั ัะพะฝะบะธะต, ะฒัั ะปะพะณะธะบะฐ ะฒ `services/`
- ะะฐะถะดัะน ัะพัั โ `requirePermission()`
- ะะฐะถะดะฐั ะผััะฐัะธั โ `logAudit()` ั snapshot
- โ fallback permissions
- โ ะฟัะฑะปะธัะฝัะต admin/health ัะฝะดะฟะพะธะฝัั ะฑะตะท auth

---

## ๐ฅ๏ธ FRONTEND ะะะะะะะ

### ะะฐะฟัะตัะตะฝะพ ะฒ ะบะพะผะฟะพะฝะตะฝัะฐั:
```javascript
// โ ะะะะะะะ
if (user.role === 'ADMIN') { }
const isExpired = daysLeft <= 0  // ะปะพะณะธะบะฐ!
const color = status === 'critical' ? 'red' : 'green'  // hardcode!
```

### ะัะฐะฒะธะปัะฝะพ:
```javascript
// โ ะะกะะะะ โ ะดะฐะฝะฝัะต ั ะฑัะบะฐ
<Badge color={item.statusColor}>{item.statusLabel}</Badge>
{permissions.canEdit && <EditButton />}
```

Backend ะฒะพะทะฒัะฐัะฐะตั:
- `status` โ enum ััะฐััั
- `statusColor` โ CSS ะบะปะฐัั/ัะฒะตั
- `statusLabel` โ ะปะพะบะฐะปะธะทะพะฒะฐะฝะฝัะน ัะตะบัั
- `permissions` โ ััะพ ะผะพะถะฝะพ ะดะตะปะฐัั ั ะพะฑัะตะบัะพะผ

---

## โก REALTIME (SSE)

ะะฐัััะพะนะบะธ (ะฑัะตะฝะดะธะฝะณ, ะฟะพัะพะณะธ, ัะตะบััั) ะผะพะณัั ะผะตะฝััััั ะฒ realtime.

UI ะดะพะปะถะตะฝ:
- ะะพะดะฟะธัะฐัััั ะฝะฐ SSE ัะพะฑััะธั
- ะะฑะฝะพะฒะปััั Context ะฟัะธ ะฟะพะปััะตะฝะธะธ ัะพะฑััะธั
- ะะ ะฟะตัะตะทะฐะณััะถะฐัั ัััะฐะฝะธัั

---

## ๐ค ะะกะะ ะะะฏะกะะ

1. **ะฏะฒะฝะพ ัะบะฐะถะธ ะดะพะฟััะตะฝะธั** ะฒ ะบะพะผะผะตะฝัะฐัะธะธ
2. **ะัะฑะธัะฐะน ัะฐะผัะน ะฑะตะทะพะฟะฐัะฝัะน ะฒะฐัะธะฐะฝั**
3. **ะัะตะดะฟะพัะธัะฐะน backend-ัะตัะตะฝะธะต** frontend-ั
4. **ะะต ะฒัะดัะผัะฒะฐะน ะฐััะธัะตะบัััั** โ ัะฟัะพัะธ
5. **ะะต ะดะพะฑะฐะฒะปัะน ัะธัะธ** ะบะพัะพััะต ะฝะต ะฟัะพัะธะปะธ

---

## ๐ ะะะกะะะฎะขะะซะ ะะะะะะขะซ

| ะะฐะฟัะตั | ะะพัะตะผั |
|--------|--------|
| Hardcoded ัะพะปะธ | ะะฐัััะฐะตั RBAC ัะธััะตะผั |
| ะะธะทะฝะตั-ะปะพะณะธะบะฐ ะฒ UI | Backend = source of truth |
| Permission fallback | ะะตะทะพะฟะฐัะฝะพััั |
| Cross-hotel ะดะพัััะฟ | ะะทะพะปััะธั ะดะฐะฝะฝัั |
| console.log ะฒ ะฟัะพะดะต | ะะตะทะพะฟะฐัะฝะพััั + ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั |
| any ะฒ TypeScript | ะขะธะฟะพะฑะตะทะพะฟะฐัะฝะพััั |
| Inline styles | ะะพะฝัะธััะตะฝัะฝะพััั ะดะธะทะฐะนะฝะฐ |
| Magic numbers | ะงะธัะฐะตะผะพััั ะบะพะดะฐ |

---

## ๐ ะคะะะะะข ะะขะะะขะ

ะัะธ ัะพะทะดะฐะฝะธะธ/ะธะทะผะตะฝะตะฝะธะธ ะบะพะดะฐ:

1. **ะะฑัััะฝะธ ัะตัะตะฝะธะต** (1-2 ะฟัะตะดะปะพะถะตะฝะธั)
2. **ะะพะบะฐะถะธ ะบะพะด** ั ะบะพะผะผะตะฝัะฐัะธัะผะธ
3. **ะฃะบะฐะถะธ ััะพ ะฟัะพะฒะตัะธัั** (ัะตะบะปะธัั)
4. **ะัะตะดัะฟัะตะดะธ ะพ ัะธัะบะฐั** (ะตัะปะธ ะตััั)
```javascript
// โ ะัะธะผะตั ัะพัะพัะตะณะพ ะพัะฒะตัะฐ:

// ะะพะฑะฐะฒะปัะตะผ SSE ะฟะพะดะฟะธัะบั ะฝะฐ ะธะทะผะตะฝะตะฝะธะต ะฑัะตะฝะดะธะฝะณะฐ
// ะััะพัะฝะธะบ: https://developer.mozilla.org/en-US/docs/Web/API/EventSource

useEffect(() => {
  const eventSource = new EventSource('/api/events/stream')
  
  eventSource.addEventListener('branding-update', (e) => {
    const data = JSON.parse(e.data)
    setBranding(data.settings) // ะะฑะฝะพะฒะปัะตะผ context
  })
  
  return () => eventSource.close()
}, [])

// ะัะพะฒะตัะธัั:
// - [ ] SSE endpoint ัััะตััะฒัะตั
// - [ ] Auth token ะฟะตัะตะดะฐัััั
// - [ ] Reconnect ะฟัะธ ะพะฑััะฒะต
```

---

## ๐ฏ ะะะะขะะะฏ ะะะะฏะขะะ
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ะัะถะฝะพ ะปะธ ััะพ?                      โ
โ  2. ะะต ะปะพะผะฐะตั ะปะธ ะฐััะธัะตะบัััั?          โ
โ  3. ะฃะดะพะฑะฝะพ ะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั?            โ
โ  4. ะะตะทะพะฟะฐัะฝะพ ะปะธ?                      โ
โ  5. ะะฐะฑะพัะฐะตั ะปะธ ะฝะฐ mobile?             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ ะัะปะธ ะฒัั ะะ โ
      ะะธัะธ ะบะพะด
```